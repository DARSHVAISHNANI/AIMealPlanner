# üçΩÔ∏è AI Personalized Meal Planner
The AI Personalized Meal Planner is a comprehensive web application built with Streamlit that leverages a suite of specialized AI agents to provide users with a complete, personalized nutrition and meal planning experience. From initial health profiling to generating daily meal plans, recipes, an interactive shopping list, and even sending reminders via WhatsApp, this tool is your all-in-one AI nutrition assistant.

## ‚ú® Features
### üë§ User Profiling
A simple interface to create or update your health profile, including goals, dietary preferences, allergies, physical stats.

### ü§ñ Multi-Agent System
Utilizes six distinct AI agents, each specialized for a specific task:

#### Nutrition Analyst Agent
- **Model:** Google Gemini  
- **Role:** Analyzes user profile data to generate a detailed, machine-readable nutrition report for other agents.  
- **Tool:** `calculate_nutrition`  
- **Description:** This function takes the user's age, gender, weight, height, activity level, and goal to perform a science-based nutritional calculation. It first determines the Basal Metabolic Rate (BMR) and Total Daily Energy Expenditure (TDEE).  
- **Goal-Based Adjustment:** It then adjusts the final calorie count based on the user's goal: it creates a 15% caloric deficit for "loss" goals, a 15% caloric surplus for "gain" goals, and maintains the TDEE for all other objectives. This ensures the plan is tailored for specific outcomes.

#### Meal Planner Agent
- **Model:** Google Gemini  
- **Role:** Uses the nutrition report to generate a complete 2-day meal plan that aligns with the user's dietary preferences and nutritional targets.  
- **Description:** This tool serves as a structured entry point for the agent. It requires the `user_profile` and `nutrition_report` as inputs, forcing the AI to use the correct data. The detailed meal plan content is generated by the LLM based on the extensive instructions provided to the agent.

#### Recipe Generator Agent
- **Model:** Gemini  
- **Role:** Generates step-by-step cooking instructions for each dish.

#### Shopping List Agent
- **Model:** Gemini  
- **Role:** Compiles a categorized shopping list from all recipes.

#### Price Predictor Agent
- **Model:** Gemini  
- **Role:** Estimates the prices for items on the shopping list.

#### WhatsApp Agent
- **Model:** Groq  
- **Role:** Crafts creative and engaging notification messages for meal reminders.

### üìù Interactive Shopping List
A dynamic shopping list where you can check off items as you buy them, with a progress bar to track your shopping trip.

### üì≤ WhatsApp Integration
Receive timely notifications for your meals directly on WhatsApp, complete with a tempting message and an image of the dish.

### üíæ Full Data Persistence
All your data, from your profile to your meal plans and shopping lists, is securely saved in a MongoDB database.

### üìä Data Dashboard
A dedicated tab to view all your generated data‚Äînutrition summary, full meal plan, recipes, and shopping list‚Äîin one beautifully formatted place.

---

## üõ†Ô∏è Tech Stack
- **Frontend:** Streamlit  
- **AI Agent Framework:** Agno  
- **LLMs:** Google Gemini  
- **Database:** MongoDB with GridFS for image storage.  
- **Cloud Services:**  
  - Cloudinary: For hosting and serving images publicly.  
  - Twilio: For sending WhatsApp notifications.  
- **Core Python Libraries:** `pymongo`, `pandas`, `python-dotenv`, `cloudinary`, `twilio`, `schedule`  

---

## Project Architecture
The application follows a modular, agent-based architecture where the UI orchestrates calls to different services and agents.

1. **User Interaction (Streamlit):** The user inputs their data through the Streamlit web interface.  
2. **Tool Processing:** Calculate nutrition needed for each user.  
3. **Agent Processing:** The application triggers a chain of AI agents. Each agent performs its specialized task (e.g., nutrition_agent calculates needs, meal_agent creates a plan).  
4. **Database Storage (MongoDB):** The output from each agent is saved in different MongoDB collections (UserCo, Nutrition_Reports, Weekly_Meal_Plans, etc.). AI-generated images are stored in GridFS.  
5. **Image Hosting (Cloudinary):** For WhatsApp integration, the images are uploaded from GridFS to Cloudinary to get a public URL.  
6. **Notifications (Twilio):** The application uses the public image URLs to send rich media messages to the user's WhatsApp via the Twilio API.  

---

## ‚ö†Ô∏è Limitations
This project is a functional prototype and has several limitations that should be considered before deploying in a production environment.

- **No User Authentication:** The application currently identifies users by their phone number, which is not a secure method.  
- **Sandbox Environment:** Twilio sandbox requires manual verification and opt-in; will not work for unverified numbers.  
- **API and Service Quotas:** Free-tier usage limits (e.g., API call caps, limited image generations) may cause failures.  

---

## üöÄ Getting Started
### 1. Prerequisites
- Python 3.8+  
- A MongoDB Atlas account (a free cluster is sufficient).  
- A Cloudinary account.  
- A Twilio account with a configured WhatsApp sandbox.  
- API keys from Google (Gemini) or Groq.  

### 2. Installation & Setup
1. Clone the repository:
   ```bash
   git clone <your-repository-url>
   cd <repository-folder>
   ```
2. Create a virtual environment and activate it:
   ```bash
   # For Windows
   python -m venv venv
   venv\Scripts\activate

   # For macOS/Linux
   python3 -m venv venv
   source venv/bin/activate
   ```
3. Install dependencies:
   ```bash
   pip install -r requirements.txt
   ```
4. Set up Environment Variables:  
   Create a file named `.env` in the root directory and add the following:
   ```ini
   GROQ_API_KEY=gsk_YourGroqApiKey
   GOOGLE_API_KEY=AIzaSy...YourGoogleApiKey
   EDAMAM_APP_KEY=...
   EDAMAM_APP_ID=...
   MONGO_URI=mongodb+srv://<user>:<password>@cluster.mongodb.net/
   MONGO_DB=YourDatabaseName
   CLOUDINARY_CLOUD_NAME=YourCloudinaryCloudName
   CLOUDINARY_API_KEY=YourCloudinaryApiKey
   CLOUDINARY_API_SECRET=YourCloudinaryApiSecret
   TWILIO_SID=AC...YourTwilioSID
   TWILIO_AUTH_TOKEN=YourTwilioAuthToken
   TWILIO_WHATSAPP_NUMBER=whatsapp:+14155238886
   GEMINI_API_KEY=AIzaSy...YourGoogleApiKey
   ```

### 3. How to Run the Application
#### Run the Streamlit Web Application
```bash
streamlit run streamlit_app.py
```
Open your browser at [http://localhost:8501](http://localhost:8501).

#### Run the Full Backend Pipeline
```bash
python main.py
```
This will:  
- Generate/update meal plans for all users.  
- Generate recipes for those plans.  
- Create shopping lists.  
- Estimate prices.  
- Upload images to Cloudinary.  
- Start the scheduler for daily WhatsApp notifications.  

---

## üìÇ File Structure
- `streamlit_app.py`: Main Streamlit UI.  
- `agents.py`: Defines all six AI agents.  
- `database.py`: MongoDB connections and helpers.  
- `main.py`: End-to-end data pipeline.  
- `utils.py`: Utility functions (e.g., image generation).  
- `upload_images.py`: Uploads images from GridFS to Cloudinary.  
- `whatsapp_message.py`: Handles WhatsApp messages via Twilio.  
- `requirements.txt`: Required Python packages.  
- `.env`: Local configuration file.  
